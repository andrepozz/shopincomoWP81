<!DOCTYPE html>
<html>
<head>
	<title>Page Title</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, target-densitydpi=medium-dpi, user-scalable=0" />
	<script type="text/javascript" src="cordova.js"></script>
	<link rel="stylesheet" href="css/themes/shopincomo.min.css" />
	<link rel="stylesheet" href="css/themes/jquery.mobile.icons.min.css" />
	<link rel="stylesheet" href="css/jquery.mobile.structure-1.4.2.min.css" />
	<link rel="stylesheet" href="css/template.css" />
	<script src="js/jquery-1.11.0.min.js"></script>
	<script src="js/jquery.mobile-1.4.2.min.js"></script>
	<script src="js/highcharts.js"></script>
	<link rel="stylesheet" href="css/leaflet.css" />
	<link rel="stylesheet" href="css/leaflet.usermarker.css" />
	<link rel="stylesheet" href="css/vetrina.css" />
	<script src="js/leaflet.js"></script>
	<script src="js/leaflet.usermarker.js"></script>
	<script src="js/function_checkConnection.js"></script>
</head>
<body>

<!-- PAGE #index -->
<div data-role="page" id="index">

	<!-- /HEADER -->
	<div data-role="header" data-position="fixed" data-tap-toggle="false">
	<h1></h1>
	</div>
	<!-- /HEADER -->
	
	<!-- CONTENT -->
	<div role="main" class="ui-content" >
	
	<script>   
	$( "#index" ).on( "pageshow", function() {	
	
	document.addEventListener("backbutton", onBackKeyDown, false);
		
		function onBackKeyDown(e) {
		e.preventDefault();
		}
	
	$(".headerUpdateDisponibili").html(""+window.localStorage.getItem("aggiornamentiDisponibili")+"");
	$(".descrizioneUpdateDisponibili").html(""+window.localStorage.getItem("aggiornamentiPopupDescrizione")+"");
	$(".buttonUpdateDisponibili").html(""+window.localStorage.getItem("aggiorna")+"");
	$(".closePopupUpdateDisponibili").html(""+window.localStorage.getItem("chiudi")+"");
		
	var lingua = window.localStorage.getItem("lingua");
	if (lingua == null) {
	
			document.addEventListener("deviceready", function(){
			$( "#setupApplicazione" ).popup("open");
			}, false);
			
	}
	else
	{
	
	//CHECK GEOLOCATION
	
	var watchID = null;
	
	document.addEventListener("deviceready", function(){
	
			var options = { maximumAge: 1500, timeout: 30000, enableHighAccuracy: false };
			watchID = navigator.geolocation.watchPosition(onSuccess, onError, options);

			
	}, false);
	

	if(window.sessionStorage.getItem("userLatitude") == null)
	{
	
	$.mobile.loading( "show", {
            text: ""+window.localStorage.getItem("localizzando")+"",
            textVisible: true,
            theme: "b",
            textonly: false
	});
	
	}
	
	function onSuccess(position) {
	var userLatitude = position.coords.latitude;
    var userLongitude = position.coords.longitude;
	var userAccuracy = position.coords.accuracy;
	
	window.sessionStorage.setItem("userLatitude", userLatitude);
	window.sessionStorage.setItem("userLongitude", userLongitude);
	window.sessionStorage.setItem("userAccuracy", userAccuracy);
	var	connectionStatus = navigator.onLine ? 'online' : 'offline';
	if (connectionStatus == "online" && window.sessionStorage.getItem("doneCheckUpdates") != "si")
	{
		checkUpdates();
	}
	else{
		$.mobile.loading( "hide" );
	}
    }
	
	function onError(error) {
						
				console.log("Geolocation Error Timeout");
				alert(""+window.localStorage.getItem("noLocalizzazione")+"");
				var userLatitude = "45.80806";
				var userLongitude = "9.08518";
				var userAccuracy = "0";
	
			window.sessionStorage.setItem("userLatitude", userLatitude);
			window.sessionStorage.setItem("userLongitude", userLongitude);
			window.sessionStorage.setItem("userAccuracy", userAccuracy);
			var	connectionStatus = navigator.onLine ? 'online' : 'offline';
			if (connectionStatus == "online" && window.sessionStorage.getItem("doneCheckUpdates") != "si")
			{
				checkUpdates();
			}
			else{
			$.mobile.loading( "hide" );
			}
		
    }
	
	function onErrorTimeout(error) {
		console.log("Geolocation Error Timeout");
		alert(""+window.localStorage.getItem("noLocalizzazione")+"");
		var userLatitude = "45.80806";
	    var userLongitude = "9.08518";
		var userAccuracy = "0";
	
		window.sessionStorage.setItem("userLatitude", userLatitude);
		window.sessionStorage.setItem("userLongitude", userLongitude);
		window.sessionStorage.setItem("userAccuracy", userAccuracy);
		var	connectionStatus = navigator.onLine ? 'online' : 'offline';
		if (connectionStatus == "online" && window.sessionStorage.getItem("doneCheckUpdates") != "si")
		{
			checkUpdates();
		}
		else{
			$.mobile.loading( "hide" );
		}
    }
	
	// SET MENU
	var codLinguaMenu = window.localStorage.getItem("codLingua");
	
	if(codLinguaMenu == "it" || codLinguaMenu == null){
	estensioneImmagine = "it";
	}
	else{
	estensioneImmagine = "en";
	}
	
	$("div#rigaBorsa_1").html("");
	$("div#rigaBorsa_2").html("");
	$("div#rigaBorsa_1").append($("<div class='blocco_sx'><a href='eserciziVicini.html' rel='external' data-transition='slide'><img src='img/ricercaDistanza_"+estensioneImmagine+".png'></a></div><div class='blocco_dx'><a href='categorie.html' rel='external' data-transition='slide'><img src='img/ricercaCategoria_"+estensioneImmagine+".png'></a></div>"));
	$("div#rigaBorsa_2").append($("<div class='blocco_sx'><a href='nomeEsercizi.html' rel='external' data-transition='slide'><img src='img/ricercaNegozio_"+estensioneImmagine+".png'></a></div><div class='blocco_dx'><a href='brandEsercizi.html' rel='external' data-transition='slide'><img src='img/ricercaBrand_"+estensioneImmagine+".png'></a></div>"));
	
	document.addEventListener("deviceready", function(){
	
	$('#index').append('<div data-role="footer" data-position="fixed" data-tap-toggle="false"><div data-role="navbar"><ul><li><a href="opzioni.html" rel="external" data-transition="slide"><img src="img/opzioni.png"></a></li><li><a href="#credits" data-transition="flip"><img src="img/info.png"></a></li></ul></div></div>').trigger( "create" );
	
	}, false);

	
	}
	
	});
	
	function checkUpdates(){
	var	connectionStatus = navigator.onLine ? 'online' : 'offline';
	if (connectionStatus == "online" && window.sessionStorage.getItem("doneCheckUpdates") != "si")
	{
		
		timeoutUpdate();
		
		$.mobile.loading( "show", {
            text: "Check Updates",
            textVisible: true,
            theme: "a",
            textonly: false
		});
	
	//CHECK ESISTENZA FILE DI SISTEMA
		
		window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem) {
			
			
			fileSystem.root.getDirectory("ShopInComo", {create: true, exclusive: false}, onGetDirectorySuccess, onGetDirectoryFail);

				function onGetDirectorySuccess(dirEntry){
								
							onSetMetadataDirectorySuccess(dirEntry);
								
				} // close onGetDirectorySuccess

				function onGetDirectoryFail(){

				console.log("Fail to get directory");

				} // close onGetDirectoryFail

				function onSetMetadataDirectorySuccess(dirEntry){
				

				// Get a directory reader
				var directoryReader = dirEntry.createReader();
				
				// Get a list of all the entries in the directory
				directoryReader.readEntries(success,fail);
				
				function success(entries) {
				
					var fileSistema = ["brandEsercizi.js","brand.js","categorie.js","nomeEsercizi.js","position.js","esercizi","categorie"];		
					
					var fileSistemaMancanti = [];
										
					for (var i=0;i<fileSistema.length;i++) {
						rv = false;
							for (var j=0;j<entries.length;j++) {
								rv = rv ||  fileSistema[i] == entries[j].name;
							}
							if(!rv)
							{
								fileSistemaMancanti.push(fileSistema[i]);
							}
					}

					checkCategorie(fileSistemaMancanti);
										
				}

				function fail(error) {
					console.log("Failed to list directory contents: " + error.code);
				}

				} // close onSetMetadataDirectorySuccess

				function onSetMetadataDirectoryFail(){

				console.log("Fail to set metadata directory");

				} // close onSetMetadataDirectoryFail
			
		}); // end of window.requestFileSystem
		
	// CHECK ESISTENZA CATEGORIE

	function checkCategorie(fileSistemaMancanti){
		window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem) {
			fileSystem.root.getDirectory("ShopInComo/categorie", {create: true, exclusive: false}, onGetDirectorySuccess, onGetDirectoryFail);

				function onGetDirectorySuccess(dirEntry){
								
							onSetMetadataDirectorySuccess(dirEntry);
								
				} // close onGetDirectorySuccess

				function onGetDirectoryFail(){

				console.log("Fail to get directory");

				} // close onGetDirectoryFail

				function onSetMetadataDirectorySuccess(dirEntry){

				// Get a directory reader
				var directoryReader = dirEntry.createReader();

				// Get a list of all the entries in the directory
				directoryReader.readEntries(success,fail);
				
				function success(entries) {
					var path = window.localStorage.getItem("pathSD");
					var jsonPath = path + "/categorie.js";
					var fileCategorieMancanti = [];		
					$.getJSON(jsonPath, function( listaCategorie ) {
						var fileCategorie = [];
						$.each(listaCategorie, function(index, info) {
						
							fileCategorie.push({
							jsonNameCategorie: info.jsonName
							});

						
						});
					
					for (var i=0;i<fileCategorie.length;i++) {
					rv = false;
					for (var j=0;j<entries.length;j++) {
					rv = rv ||  fileCategorie[i].jsonNameCategorie == entries[j].name.substring(0, entries[j].name.length - 3);
					}
					if(!rv)
					{
					fileCategorieMancanti.push(fileCategorie[i].jsonNameCategorie);
					}
					}
					//eserciziUpdate(fileCategorieMancanti);
					checkVetrine(fileSistemaMancanti, fileCategorieMancanti);
					//window.sessionStorage.setItem("fileEserciziMancanti", JSON.stringify(fileEserciziMancanti));
					});
					
				}

				function fail(error) {
					console.log("Failed to list directory contents: " + error.code);
				}

				} // close onSetMetadataDirectorySuccess

				function onSetMetadataDirectoryFail(){

				console.log("Fail to set metadata directory");

				} // close onSetMetadataDirectoryFail
			
		}); // end of window.requestFileSystem
		
	} // END FUNCTION CHECK CATEGORIE

	// CHECK ESISTENZA VETRINE
	function checkVetrine(fileSistemaMancanti, fileCategorieMancanti) {	
		window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem) {
			
			fileSystem.root.getDirectory("ShopInComo/esercizi", {create: true, exclusive: false}, onGetDirectorySuccess, onGetDirectoryFail);

				function onGetDirectorySuccess(dirEntry){

							onSetMetadataDirectorySuccess(dirEntry);

								
				} // close onGetDirectorySuccess

				function onGetDirectoryFail(){

				console.log("Fail to get directory");

				} // close onGetDirectoryFail

				function onSetMetadataDirectorySuccess(dirEntry){
			
				// Get a directory reader
				var directoryReader = dirEntry.createReader();

				// Get a list of all the entries in the directory
				directoryReader.readEntries(success,fail);
				
				function success(entries) {
					var path = window.localStorage.getItem("pathSD");
					var jsonPath = path + "/nomeEsercizi.js";

					var fileEserciziMancanti = [];		
					$.getJSON(jsonPath, function( listaEsercizi ) {
						var idEsercizi = [];
						$.each(listaEsercizi, function(index, info) {
						
							idEsercizi.push({
							idEsercizio: info.idEsercizio
							});

						
						});
					
					for (var i=0;i<idEsercizi.length;i++) {
					rv = false;
					for (var j=0;j<entries.length;j++) {
					rv = rv ||  parseInt(idEsercizi[i].idEsercizio) == parseInt(entries[j].name.substring(0, entries[j].name.length - 3));
					}
					if(!rv)
					{
					fileEserciziMancanti.push(idEsercizi[i].idEsercizio);
					}
					}
					eserciziUpdate(fileSistemaMancanti, fileCategorieMancanti, fileEserciziMancanti);
					window.sessionStorage.setItem("fileEserciziMancanti", JSON.stringify(fileEserciziMancanti));
					});
					
				}

				function fail(error) {
					console.log("Failed to list directory contents: " + error.code);
				}

				} // close onSetMetadataDirectorySuccess

				function onSetMetadataDirectoryFail(){

				console.log("Fail to set metadata directory");

				} // close onSetMetadataDirectoryFail
			
		}); // end of window.requestFileSystem
	
	} // END FUNCTION CHECK VETRINE
		
	function eserciziUpdate(fileSistemaMancanti, fileCategorieMancanti, fileEserciziMancanti){

		window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem) {
			
			fileSystem.root.getDirectory("ShopInComo", {create: true, exclusive: false}, onGetDirectorySuccess, onGetDirectoryFail);


				function onGetDirectorySuccess(dirEntry){

					//MEMORIZZA PATH
					var directory = dirEntry.fullPath;
								
							onSetMetadataDirectorySuccess(dirEntry);

								
				} // close onGetDirectorySuccess

				function onGetDirectoryFail(){

				console.log("Fail to get directory");

				} // close onGetDirectoryFail

				function onSetMetadataDirectorySuccess(dirEntry){
				
				dirEntry.getFile("categorie.js", {create: true, exclusive: false}, onGetFileSuccess, onGetFileFail);

				} // close onSetMetadataDirectorySuccess

				function onSetMetadataDirectoryFail(){

				console.log("Fail to set metadata directory");

				} // close onSetMetadataDirectoryFail


				function onGetFileSuccess(fileEntry){

							onSetMetadataFileSuccess(fileEntry);

				} // close onGetFileSuccess

				function onGetFileFail(){

					console.log("Fail to get file");

				} // close onGetFileFail

				function onSetMetadataFileSuccess(fileEntry){
									
					fileEntry.getMetadata(function(metadata) {
					
						var dataDownload = Math.round(localStorage.getItem("lastDownload")/ 1000);
					
					
					localStorage.setItem("dataDownload", dataDownload );
					
					var urlJSON = "http://shopincomo.comune.como.it/ccn20/JSONidEserciziUpdate.php?language="+localStorage.getItem("codLingua")+"&dataDownload="+dataDownload;
						
						$.ajax({
							url: "http://shopincomo.comune.como.it/ccn20/JSONidEserciziUpdate.php",
							type: "GET",
							dataType: "json",
							data: {language: localStorage.getItem("codLingua"), dataDownload: dataDownload},
							timeout: 15000
						}).done(function(response){
							if (response.length == 0 && fileEserciziMancanti.length == 0 && fileSistemaMancanti.length == 0 && fileCategorieMancanti.length == 0) {
								localStorage.setItem("numeroAggiornamenti", 0);
								//alert("NO aggiornamenti disponibili");
								//$("p.countUpdates").html(""+window.localStorage.getItem("statusDatabase")+"");
								$.mobile.loading( "hide" );
							}
							else {
								numeroAggiornamenti = response.length + fileEserciziMancanti.length + fileSistemaMancanti.length + fileCategorieMancanti.length;
								localStorage.setItem("numeroAggiornamenti", numeroAggiornamenti);
								$( "#updateDisponibili" ).popup("open");
								$.mobile.loading( "hide" );
							}
						}).fail(function(jqXHR, textStatus){
							if(textStatus == 'timeout')
							{     
								if (fileEserciziMancanti.length == 0 && fileSistemaMancanti.length == 0 && fileCategorieMancanti.length == 0) {
								$.mobile.loading( "hide" );
								}
								else {
									$( "#updateDisponibili" ).popup("open");
									$.mobile.loading( "hide" );
								}
							}
							else
							{
								if (fileEserciziMancanti.length == 0 && fileSistemaMancanti.length == 0 && fileCategorieMancanti.length == 0) {
								$.mobile.loading( "hide" );
								}
								else {
									$( "#updateDisponibili" ).popup("open");
									$.mobile.loading( "hide" );
								}
							}
						});
					
					}); // end fileEntry.getMetadata
				}
					 
				function onSetMetadataFileFail(){

					console.log("Fail to set metadata file");

				} // close onSetMetadataFileFail
			
		}); // end of window.requestFileSystem
		
	} // end of eserciziUpdate

	var doneCheckUpdates = "si"
	window.sessionStorage.setItem("doneCheckUpdates", doneCheckUpdates);
	}
	}
	//FINE CHECK UPDATES
	
	function timeoutUpdate()
	{
		setTimeout(function(){
		$.mobile.loading( "hide" );
		},15000);
	}
	
	//FINE TIMEOUT UPDATES
	

	
	$(document).on("click", 'a.closePopupUpdateDisponibili', function(){
		
		$( "#updateDisponibili" ).popup("close");
		
	});
		
	</script>

	<div id="manicoBorsa">
	<img src="img/manico.png">
	</div>
	<div id="rigaBorsa_1">
	</div>
	<div id="rigaBorsa_2">
	</div>
	
	<div data-role="popup" id="setupApplicazione" data-dismissible="false" data-history="false">
	<p class="headersetupApplicazione">Warning</p>
    <p class="descrizionesetupApplicazione">Setup Applicazione Necessario / Application Setup</p>
	<a href="#lingue" class="ui-btn buttonsetupApplicazione">SETUP</a>
	</div>
	
	
	<div data-role="popup" id="updateDisponibili" data-dismissible="false" data-history="false">
	<p class="headerUpdateDisponibili"></p>
    <p class="descrizioneUpdateDisponibili"></p>
	<a href="opzioni.html" rel="external" class="ui-btn buttonUpdateDisponibili">Update</a>
	<a href="#" class="ui-btn closePopupUpdateDisponibili"></a>
	</div>
	
	</div>
	<!-- /CONTENT -->

	<!-- FOOTER -->
	<!-- /FOOTER -->
	
</div><!-- /PAGE #index -->

<!-- PAGE #lingue -->
	<div data-role="page" id="lingue">

	<!-- /HEADER -->
	<div data-role="header" data-position="fixed" data-tap-toggle="false">
		<h1></h1>
	</div>
	<!-- /HEADER -->
	
	<!-- CONTENT -->
	<div role="main" class="ui-content" >
	
	<script>
  
	$( "#lingue" ).on( "pagebeforeshow", function() {
	
	
	document.addEventListener("backbutton", onBackKeyDown, false);
		
		function onBackKeyDown(e) {
		e.preventDefault();
		}
	
	//LISTA LINGUE
	$("ul#listaLingue").html("");
	
		var fileLingueJson = '{"Italiano":{"idLingua":"1","codiceLingua":"it","nomeLingua":"Italiano","nome":"Nome","nomiEsercizi":"nomiEsercizi","categorie":"categorie","esercizi":"esercizi","position":"posizioneEsercizi","sottoCategorie":"sottocategorie","brandEsercizi":"brandEsercizi","downloadFunzionalita":"Download funzionalit\u00e0","downloadEsercizi":"Download Esercizi","attendere":"attendere","continua":"Continua","localizzando":"Localizzando","noLocalizzazione":"Non \u00e8 stato possibile localizzarti. La tua posizione verr\u00e0 impostata di default al centro di Como","salta":"Salta","chiudi":"Chiudi","vota":"Vota","voti":"Voti","essereOnline":"Bisogna essere collegati in WiFi o 3g per usare questa funzionalit\u00e0","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distanza","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"Tutti","giorni":"giorni","noStatistiche":"Il negoziante non permette la visualizzazione pubblica delle statistiche","contatti":"Contatti","telefono":"Telefono","orariApertura":"Orari di apertura","noOrari":"Orari di apertura non comunicati","lunedi":"Luned\u00ec","martedi":"Marted\u00ec","mercoledi":"Mercoled\u00ec","giovedi":"Gioved\u00ec","venerdi":"Venerd\u00ec","sabato":"Sabato","domenica":"Domenica","votaNegozio":"Vota il negozio","portamiQui":"Portami qui","mostra":"mostra","nascondi":"nascondi","postPubblicato":"Post pubblicato","tweetPubblicato":"Tweet pubblicato","checkinPubblicato":"Check-in pubblicato","noCheckin":"Non sei nelle vicinanze di questo negozio!","noRisultatiVicini":"Non ci sono risultati nelle vicinanze","noRisultatiBrand":"Nessun brand corrisponde alla ricerca","noRisultatiNome":"Nessun esercizio corrisponde alla ricerca","vicinoA":"Ora sei vicino a","troppoLontano":"troppo lontano per calcolare","collegaSetupTitolo":"Collegati con","collegaSetupDescrizione":"Puoi collegare ShopInComo con i Social Network per votare i tuoi negozi preferiti","collegaSocial":"Collega ShopInComo al mio account","noCollegaSocial":"Non ora","accountCollegato":"Account Collegato","prossimoPasso":"Prossimo step","placeholderNome":"Inserisci il nome di un negozio (almeno 3 lettere)","placeholderBrand":"Inserisci un brand (almeno 3 lettere)","linguaApp":"Lingua","cambiaLinguaApp":"Cambia lingua","aggiorna":"Aggiorna","aggiornaDatabaseApp":"Aggiorna il database degli esercizi","statusDatabase":"Non sono disponibili aggiornamenti","aggiornamentoCompletato":"Aggiornamento completato","aggiornamentiDisponibili":"Aggiornamenti disponibili","aggiornamentiPopupDescrizione":"Sono disponibili aggiornamenti per gli esercizi"},"English":{"idLingua":"2","codiceLingua":"en","nomeLingua":"English","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Francaise":{"idLingua":"3","codiceLingua":"fr","nomeLingua":"Francaise","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Spanish":{"idLingua":"4","codiceLingua":"es","nomeLingua":"Spanish","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Portuguese":{"idLingua":"5","codiceLingua":"pt","nomeLingua":"Portuguese","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Russian":{"idLingua":"6","codiceLingua":"ru","nomeLingua":"Russian","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Japanese":{"idLingua":"7","codiceLingua":"ja","nomeLingua":"Japanese","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Chinese":{"idLingua":"8","codiceLingua":"zh-hans","nomeLingua":"Chinese","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Arabic":{"idLingua":"9","codiceLingua":"ar","nomeLingua":"Arabic","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"}}';
		var fileLingue = JSON.parse(fileLingueJson);
				
			$.each(fileLingue, function(index, info) {
			$("ul#listaLingue").append($("<li></li>",{"html":"<a href='#setupCategorie' class='lingua' id='" + info.idLingua + "' codiceLingua='"+info.codiceLingua+"' nomeLingua='"+index+"' data-transition='slide' ><img src='img/lingue/"+info.codiceLingua+".png' class='ui-li-icon ui-corner-none'>" + info.nomeLingua + "</a>" }));
			});
	
			$("ul#listaLingue").listview("refresh");
	
	}); //ON "pagebeforeshow"
	
	//ON "click"
	$(document).on("click", 'a.lingua', function(){
	
	var	connectionStatus = navigator.onLine ? 'online' : 'offline';
	
	if (connectionStatus == "online")
	{
	idLingua = $(this).attr('id');
	lingua = $(this).attr('nomeLingua');
	codLingua = $(this).attr('codiceLingua');
	alert("codLingua");
	
	window.localStorage.setItem("lingua", lingua);
	window.localStorage.setItem("idLingua", idLingua);
	window.localStorage.setItem("codLingua", codLingua);
	
	// TRADUZIONI------------------------------------------------------------------------------
	
	var fileLingueJson = '{"Italiano":{"idLingua":"1","codiceLingua":"it","nomeLingua":"Italiano","nome":"Nome","nomiEsercizi":"nomiEsercizi","categorie":"categorie","esercizi":"esercizi","position":"posizioneEsercizi","sottoCategorie":"sottocategorie","brandEsercizi":"brandEsercizi","downloadFunzionalita":"Download funzionalit\u00e0","downloadEsercizi":"Download Esercizi","attendere":"attendere","continua":"Continua","localizzando":"Localizzando","noLocalizzazione":"Non \u00e8 stato possibile localizzarti. La tua posizione verr\u00e0 impostata di default al centro di Como","salta":"Salta","chiudi":"Chiudi","vota":"Vota","voti":"Voti","essereOnline":"Bisogna essere collegati in WiFi o 3g per usare questa funzionalit\u00e0","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distanza","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"Tutti","giorni":"giorni","noStatistiche":"Il negoziante non permette la visualizzazione pubblica delle statistiche","contatti":"Contatti","telefono":"Telefono","orariApertura":"Orari di apertura","noOrari":"Orari di apertura non comunicati","lunedi":"Luned\u00ec","martedi":"Marted\u00ec","mercoledi":"Mercoled\u00ec","giovedi":"Gioved\u00ec","venerdi":"Venerd\u00ec","sabato":"Sabato","domenica":"Domenica","votaNegozio":"Vota il negozio","portamiQui":"Portami qui","mostra":"mostra","nascondi":"nascondi","postPubblicato":"Post pubblicato","tweetPubblicato":"Tweet pubblicato","checkinPubblicato":"Check-in pubblicato","noCheckin":"Non sei nelle vicinanze di questo negozio!","noRisultatiVicini":"Non ci sono risultati nelle vicinanze","noRisultatiBrand":"Nessun brand corrisponde alla ricerca","noRisultatiNome":"Nessun esercizio corrisponde alla ricerca","vicinoA":"Ora sei vicino a","troppoLontano":"troppo lontano per calcolare","collegaSetupTitolo":"Collegati con","collegaSetupDescrizione":"Puoi collegare ShopInComo con i Social Network per votare i tuoi negozi preferiti","collegaSocial":"Collega ShopInComo al mio account","noCollegaSocial":"Non ora","accountCollegato":"Account Collegato","prossimoPasso":"Prossimo step","placeholderNome":"Inserisci il nome di un negozio (almeno 3 lettere)","placeholderBrand":"Inserisci un brand (almeno 3 lettere)","linguaApp":"Lingua","cambiaLinguaApp":"Cambia lingua","aggiorna":"Aggiorna","aggiornaDatabaseApp":"Aggiorna il database degli esercizi","statusDatabase":"Non sono disponibili aggiornamenti","aggiornamentoCompletato":"Aggiornamento completato","aggiornamentiDisponibili":"Aggiornamenti disponibili","aggiornamentiPopupDescrizione":"Sono disponibili aggiornamenti per gli esercizi"},"English":{"idLingua":"2","codiceLingua":"en","nomeLingua":"English","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Francaise":{"idLingua":"3","codiceLingua":"fr","nomeLingua":"Francaise","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Spanish":{"idLingua":"4","codiceLingua":"es","nomeLingua":"Spanish","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Portuguese":{"idLingua":"5","codiceLingua":"pt","nomeLingua":"Portuguese","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Russian":{"idLingua":"6","codiceLingua":"ru","nomeLingua":"Russian","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Japanese":{"idLingua":"7","codiceLingua":"ja","nomeLingua":"Japanese","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Chinese":{"idLingua":"8","codiceLingua":"zh-hans","nomeLingua":"Chinese","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"},"Arabic":{"idLingua":"9","codiceLingua":"ar","nomeLingua":"Arabic","nome":"Name","nomiEsercizi":"shopNames","position":"shopPosition","categorie":"categories","esercizi":"shops","sottoCategorie":"subcategories","brandEsercizi":"shopBrand","downloadFunzionalita":"Download functionalities","downloadEsercizi":"Download Shops","attendere":"wait","continua":"Next","localizzando":"Geolocating","noLocalizzazione":"Geolocation fail. Default position city center","salta":"Skip","chiudi":"Close","vota":"Vote","voti":"Votes","essereOnline":"Must be connected to WiFi or 3g to use this functionality","onlineSetup":"Il collegamento WiFi o 3g \u00e8 necessario per il setup della App","distanza":"Distance","votoTrendy":"Trendy","votoPopular":"Popular","tutti":"All","giorni":"days","noStatistiche":"Shoopkeeper does not allow public viewing of statistics","contatti":"Contacts","telefono":"Phone","orariApertura":"Opening Hours","noOrari":"Opening hours not available","lunedi":"Monday","martedi":"Tuesday","mercoledi":"Wednesday","giovedi":"Thursday","venerdi":"Friday","sabato":"Saturday","domenica":"Sunday","votaNegozio":"Vote shop","portamiQui":"Bring me here","mostra":"show","nascondi":"hide","postPubblicato":"Post published","tweetPubblicato":"Tweet published","checkinPubblicato":"Check-in published","noCheckin":"Not near this shop!","troppoLontano":"too far to calculate","noRisultatiVicini":"No results nearby","noRisultatiBrand":"No results available","noRisultatiNome":"No results available","vicinoA":"Now you are close to","collegaSetupTitolo":"Connect with","collegaSetupDescrizione":"You can connect ShopInComo with Social Network to vote your favorites shops","collegaSocial":"Connect ShopInComo with my account","noCollegaSocial":"Skip now","accountCollegato":"Account Connected","prossimoPasso":"Next Step","placeholderNome":"Insert shop name (at least 3 characters)","placeholderBrand":"Insert a brand (at least 3 characters)","linguaApp":"Language","cambiaLinguaApp":"Change language","aggiorna":"Update","aggiornaDatabaseApp":"Update shop database","statusDatabase":"No updates available","aggiornamentoCompletato":"Update complete","aggiornamentiDisponibili":"Updates available","aggiornamentiPopupDescrizione":"Updates available for shops in Application"}}';
	var lingue = JSON.parse(fileLingueJson);	
		
	window.localStorage.setItem("nome", lingue[lingua].nome);
	window.localStorage.setItem("nomiEsercizi", lingue[lingua].nomiEsercizi);
	window.localStorage.setItem("position", lingue[lingua].position);
	window.localStorage.setItem("categorie", lingue[lingua].categorie);
	window.localStorage.setItem("esercizi", lingue[lingua].esercizi);
	window.localStorage.setItem("sottoCategorie", lingue[lingua].sottoCategorie);
	window.localStorage.setItem("brandEsercizi", lingue[lingua].brandEsercizi);
	window.localStorage.setItem("downloadFunzionalita", lingue[lingua].downloadFunzionalita);
	window.localStorage.setItem("downloadEsercizi", lingue[lingua].downloadEsercizi);
	window.localStorage.setItem("attendere", lingue[lingua].attendere);
	window.localStorage.setItem("continua", lingue[lingua].continua);
	window.localStorage.setItem("localizzando", lingue[lingua].localizzando);
	window.localStorage.setItem("noLocalizzazione", lingue[lingua].noLocalizzazione);
	window.localStorage.setItem("salta", lingue[lingua].salta);
	window.localStorage.setItem("chiudi", lingue[lingua].chiudi);
	window.localStorage.setItem("vota", lingue[lingua].vota);
	window.localStorage.setItem("voti", lingue[lingua].voti);
	window.localStorage.setItem("essereOnline", lingue[lingua].essereOnline);
	window.localStorage.setItem("onlineSetup", lingue[lingua].onlineSetup);
	window.localStorage.setItem("distanza", lingue[lingua].distanza);
	window.localStorage.setItem("votoTrendy", lingue[lingua].votoTrendy);
	window.localStorage.setItem("votoPopular", lingue[lingua].votoPopular);
	window.localStorage.setItem("tutti", lingue[lingua].tutti);
	window.localStorage.setItem("giorni", lingue[lingua].giorni);
	window.localStorage.setItem("noStatistiche", lingue[lingua].noStatistiche);
	window.localStorage.setItem("contatti", lingue[lingua].contatti);
	window.localStorage.setItem("telefono", lingue[lingua].telefono);
	window.localStorage.setItem("orariApertura", lingue[lingua].orariApertura);
	window.localStorage.setItem("noOrari", lingue[lingua].noOrari);
	window.localStorage.setItem("lunedi", lingue[lingua].lunedi);
	window.localStorage.setItem("martedi", lingue[lingua].martedi);
	window.localStorage.setItem("mercoledi", lingue[lingua].mercoledi);
	window.localStorage.setItem("giovedi", lingue[lingua].giovedi);
	window.localStorage.setItem("venerdi", lingue[lingua].venerdi);
	window.localStorage.setItem("sabato", lingue[lingua].sabato);
	window.localStorage.setItem("domenica", lingue[lingua].domenica);
	window.localStorage.setItem("votaNegozio", lingue[lingua].votaNegozio);
	window.localStorage.setItem("portamiQui", lingue[lingua].portamiQui);
	window.localStorage.setItem("mostra", lingue[lingua].mostra);
	window.localStorage.setItem("nascondi", lingue[lingua].nascondi);
	window.localStorage.setItem("postPubblicato", lingue[lingua].postPubblicato);
	window.localStorage.setItem("tweetPubblicato", lingue[lingua].tweetPubblicato);
	window.localStorage.setItem("checkinPubblicato", lingue[lingua].checkinPubblicato);
	window.localStorage.setItem("noCheckin", lingue[lingua].noCheckin);
	window.localStorage.setItem("troppoLontano", lingue[lingua].troppoLontano);
	window.localStorage.setItem("noRisultatiVicini", lingue[lingua].noRisultatiVicini);
	window.localStorage.setItem("noRisultatiBrand", lingue[lingua].noRisultatiBrand);
	window.localStorage.setItem("noRisultatiNome", lingue[lingua].noRisultatiNome);
	window.localStorage.setItem("vicinoA", lingue[lingua].vicinoA);
	window.localStorage.setItem("collegaSetupTitolo", lingue[lingua].collegaSetupTitolo);
	window.localStorage.setItem("collegaSetupDescrizione", lingue[lingua].collegaSetupDescrizione);
	window.localStorage.setItem("collegaSocial", lingue[lingua].collegaSocial);
	window.localStorage.setItem("noCollegaSocial", lingue[lingua].noCollegaSocial);
	window.localStorage.setItem("accountCollegato", lingue[lingua].accountCollegato);
	window.localStorage.setItem("prossimoPasso", lingue[lingua].prossimoPasso);
	window.localStorage.setItem("placeholderNome", lingue[lingua].placeholderNome);
	window.localStorage.setItem("placeholderBrand", lingue[lingua].placeholderBrand);
	window.localStorage.setItem("linguaApp", lingue[lingua].linguaApp);
	window.localStorage.setItem("cambiaLinguaApp", lingue[lingua].cambiaLinguaApp);
	window.localStorage.setItem("aggiorna", lingue[lingua].aggiorna);
	window.localStorage.setItem("aggiornaDatabaseApp", lingue[lingua].aggiornaDatabaseApp);
	window.localStorage.setItem("statusDatabase", lingue[lingua].statusDatabase);
	window.localStorage.setItem("aggiornamentoCompletato", lingue[lingua].aggiornamentoCompletato);
	window.localStorage.setItem("aggiornamentiDisponibili", lingue[lingua].aggiornamentiDisponibili);
	window.localStorage.setItem("aggiornamentiPopupDescrizione", lingue[lingua].aggiornamentiPopupDescrizione);
	
	// /TRADUZIONI----------------------------------------------------------------------------
	//$.mobile.changePage( "#setupCategorie", { allowSamePageTransition:true, transition: "slide" } );
	}
	else
	{
	$( "#connectionOfflineLingua" ).popup("open");
	}
	
	
	}); //ON "click"
	
	$(document).on("click", 'a.closePopup', function(){
		
		$( "#connectionOfflineLingua" ).popup("close");
		
	});
	
	</script>

	<ul data-role="listview" id="listaLingue" data-inset="true">
	</ul>
	
	<div data-role="popup" id="connectionOfflineLingua" data-dismissible="false" data-history="false">
	<p class="headerOffline">OFFLINE</p>
    <p class="descrizioneOffline">Il setup dell'Applicazione richiede una connessione WiFi o 3g</p>
	<p class="descrizioneOffline">WiFi or 3g connection is necessary to setup the Application</p>
	<a href="#" class="ui-btn closePopup">Riprova/Try Agay</a>
	</div>
	
	</div>
	<!-- CONTENT -->

	<!-- FOOTER -->
	<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		<h4></h4>
	</div>
	<!-- /FOOTER -->

	</div>
<!-- /PAGE #lingue -->

<!-- PAGE #setupCategorie -->
	<div data-role="page" id="setupCategorie">

	<!-- /HEADER -->
	<div data-role="header" data-position="fixed" data-tap-toggle="false">
		<h1></h1>
	</div>
	<!-- /HEADER -->
	
	<!-- CONTENT -->
	<div role="main" class="ui-content" >
	
	<script>   
	$( "#setupCategorie" ).on( "pageshow", function() {	
	
	document.addEventListener("backbutton", onBackKeyDown, false);
		
	function onBackKeyDown(e) {
	e.preventDefault();
	}

	
	$("h3.titoloDownloadFunzionalita").html(window.localStorage.getItem("downloadFunzionalita"));
	
	$("ul.downloadList").append($('<li class="'+window.localStorage.getItem("nomiEsercizi")+'"><img class="iconaTipologia" src="img/downloadnome.png"> DOWNLOAD '+window.localStorage.getItem("nomiEsercizi")+'... <img src="img/download.gif"></li>'));
	$("ul.downloadList").append($('<li class="brand"><img class="iconaTipologia" src="img/downloadbrand.png"> DOWNLOAD brand... <img src="img/download.gif"></li>'));
	$("ul.downloadList").append($('<li class="'+window.localStorage.getItem("brandEsercizi")+'"><img class="iconaTipologia" src="img/downloadbrandEsercizi.png"> DOWNLOAD '+window.localStorage.getItem("brandEsercizi")+'... <img src="img/download.gif"></li>'));
	$("ul.downloadList").append($('<li class="'+window.localStorage.getItem("position")+'"><img class="iconaTipologia" src="img/downloadposition.png"> DOWNLOAD position... <img src="img/download.gif"></li>'));
	$("ul.downloadList").append($('<li class="categorie"><img class="iconaTipologia" src="img/downloadCategorie.png"> DOWNLOAD '+window.localStorage.getItem("categorie")+'...<img src="img/download.gif"></li>'));
	$("ul.downloadList").append($('<li class="sottocategorie"><img class="iconaTipologia" src="img/downloadSottocategorie.png"> DOWNLOAD '+window.localStorage.getItem("sottoCategorie")+'...<img src="img/download.gif"></li>'));
		
				
		
	}); // ON "pageshow"
	
	
	
	
	</script>
	
	<h3 class="titoloDownloadFunzionalita"></h3>
	
	<ul class="downloadList">
	</ul>
	
	<p class="downloadComplete"><img src="img/download.gif"></p>
	
	</div>
	<!-- CONTENT -->

	<!-- FOOTER -->
	<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		<h4></h4>
	</div>
	<!-- /FOOTER -->

</div>
<!-- /PAGE #setupCategorie -->

<!-- PAGE #setupNegozi -->
	<div data-role="page" id="setupNegozi">

	<!-- /HEADER -->
	<div data-role="header" data-position="fixed" data-tap-toggle="false">
		<h1></h1>
	</div>
	<!-- /HEADER -->
	
	<!-- CONTENT -->
	<div role="main" class="ui-content" >
	
	<script>   
	$( "#setupNegozi" ).on( "pageshow", function() {	
	
	document.addEventListener("backbutton", onBackKeyDown, false);
		
	function onBackKeyDown(e) {
	e.preventDefault();
	}
	
	$("h3.titoloDownloadEsercizi").html(window.localStorage.getItem("downloadEsercizi"));
	
	$.ajax({
		url: "http://shopincomo.comune.como.it/ccn20/JSONidEsercizi.php?start=0&end=2000",
		dataType: 'json',
		success: function(data) {
		
		var totaleEsercizi = data.length;
		
		var numeroBlocchiDownload = Math.floor(totaleEsercizi/50);
		var widthBlocchiDownload = 100/numeroBlocchiDownload;
		for (i=1; i<=numeroBlocchiDownload; i++) {
		$("div.progressBar").append("<div class='"+i+"' style='width:"+widthBlocchiDownload.toFixed(2)+"%; height:40px; float:left'></div>");
		}
		
		window.sessionStorage.setItem("totaleEsercizi", totaleEsercizi);
		window.sessionStorage.setItem("start", 0);
		window.sessionStorage.setItem("iteration", 1);
		
		downloadVetrineInterval();
		}
	});
	
	}); // ON "pageshow"
	
	
	function downloadVetrineInterval() {
	
	var lastDownload = new Date();
	var lastDownload = lastDownload.getTime();
	
	window.localStorage.setItem('lastDownload', lastDownload);
	
	var start = window.sessionStorage.getItem('start');
	
	$.ajax({	
		url: "http://shopincomo.comune.como.it/ccn20/JSONidEsercizi.php?start="+start+"&end=50",
		dataType: 'json',
		success: function(data) {
		
		var codLingua = window.localStorage.getItem('codLingua');
		
			$.each(data, function(index, info) {
		
			var urlEsercizi = encodeURI("http://shopincomo.comune.como.it/ccn20/JSONvetrinaEsercizio.php?language="+codLingua+"&idEsercizio="+info.idEsercizio+"");	
			var fileNameEsercizi = info.idEsercizio+".js";	
			var directoryEsercizi = "ShopInComo/esercizi";
		
			downloadVetrine(directoryEsercizi, fileNameEsercizi, urlEsercizi);
			});
		}
	});
	
	}//FUNCTION INTERVAL VETRINE
	
	
	//DOWNLOAD VETRINE
	function downloadVetrine(directory, fileName, fileURL, start, totaleEsercizi) {

		var fileTransfer = new FileTransfer();
		
		window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem) {

						fileSystem.root.getDirectory(directory, {create: true, exclusive: false}, onGetDirectorySuccess, onGetDirectoryFail);

				function onGetDirectorySuccess(dirEntry){

					//MEMORIZZA PATH
					var directory = dirEntry.fullPath;
								
							onSetMetadataDirectorySuccess(dirEntry);
								
				} // close onGetDirectorySuccess

				function onGetDirectoryFail(){

				console.log("Fail to get directory");

				} // close onGetDirectoryFail

				function onSetMetadataDirectorySuccess(dirEntry){
				
				dirEntry.getFile(fileName, {create: true, exclusive: false}, onGetFileSuccess, onGetFileFail);

				} // close onSetMetadataDirectorySuccess

				function onSetMetadataDirectoryFail(){

				console.log("Fail to set metadata directory");

				} // close onSetMetadataDirectoryFail


				function onGetFileSuccess(fileEntry){

						onSetMetadataFileSuccess(fileEntry);

				} // close onGetFileSuccess

				function onGetFileFail(){

					console.log("Fail to get file");

				} // close onGetFileFail

				function onSetMetadataFileSuccess(fileEntry){
										
					var localPath = fileEntry.fullPath;

					
					fileTransfer.download(
						fileURL,
						localPath,
						function(entry) {
						
						var count = window.sessionStorage.getItem("start");
						var iteration = window.sessionStorage.getItem("iteration");
						
						count = parseInt(count)+1;
						window.sessionStorage.setItem("start", count);
													
							if(count == window.sessionStorage.getItem("totaleEsercizi")) {
							
							$("li.downloadVetrine").html("download vetrine <img src='img/downloadok.png'>");
							$("li.downloadVetrine").css("color","#00CC00");	
							$("div.progressBar").css("background","#00CC00");
							
								$("p.downloadCompleteVetrina").html("<a href='#foursquare' class='ui-btn' data-transition='slide'>"+window.localStorage.getItem("continua")+"</a>");
							
							
							//$("p.downloadCompleteVetrina").html("<a href='#facebook' class='ui-btn' data-transition='slide'>"+window.localStorage.getItem("continua")+"</a>");
							}
							else if(count == parseInt(iteration)*50) {
							
							$("div."+iteration+"").css("background","#00CC00");	
							iteration = parseInt(iteration)+1;
							window.sessionStorage.setItem("iteration", iteration);
							
							downloadVetrineInterval();
							}
						},
						function(error) {
												
							var countError = window.sessionStorage.getItem("start");
							var iterationError = window.sessionStorage.getItem("iteration");
						
							countError = parseInt(countError)+1;
							window.sessionStorage.setItem("start", countError);
													
							if(countError == window.sessionStorage.getItem("totaleEsercizi")) {
							
							$("li.downloadVetrine").html("download vetrine <img src='img/downloadok.png'>");
							$("li.downloadVetrine").css("color","#00CC00");	
							$("div.progressBar").css("background","#00CC00");
							
								$("p.downloadCompleteVetrina").html("<a href='#foursquare' class='ui-btn' data-transition='slide'>"+window.localStorage.getItem("continua")+"</a>");
							
							//$("p.downloadCompleteVetrina").html("<a href='#facebook' class='ui-btn' data-transition='slide'>"+window.localStorage.getItem("continua")+"</a>");
							}
							else if(countError == parseInt(iterationError)*50) {
							
							$("div."+iterationError+"").css("background","#00CC00");	
							iterationError = parseInt(iterationError)+1;
							window.sessionStorage.setItem("iteration", iterationError);
							
							downloadVetrineInterval();
							}
						},
						false,
						{
							headers: {
								"Authorization": "Basic dGVzdHVzZXJuYW1lOnRlc3RwYXNzd29yZA=="
							}
						}
				
					); // end of fileTransfer.download
				} // close onSetMetadataFileSuccess

				function onSetMetadataFileFail(){

					console.log("Fail to set metadata file");

				} // close onSetMetadataFileFail
			
		}); // end of window.requestFileSystem
		
	} //FUNCTION DOWNLOAD VETRINE
	
	</script>
	
	<h3 class="titoloDownloadEsercizi"></h3>
	
	<div class="progressBar" style="width: 100%; height: 40px; background:#C0C0C0">
	</div>
		
	<!--
	<ul style="list-style-type: none">
	<li class="downloadVetrine">download vetrine...<img src="img/download.gif"></li>
	</ul>
	-->
	
	<p class="downloadCompleteVetrina"><img src="img/download.gif"></p>
	
	</div>
	<!-- CONTENT -->

	<!-- FOOTER -->
	<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		<h4></h4>
	</div>
	<!-- /FOOTER -->

</div>
<!-- /PAGE #setupNegozi -->


<!-- PAGE #foursquare -->
	<div data-role="page" id="foursquare">

	<!-- /HEADER -->
	<div data-role="header" data-position="fixed" data-tap-toggle="false">
		<h1></h1>
	</div>
	<!-- /HEADER -->
	
	<!-- CONTENT -->
	<div role="main" class="ui-content" >
	
	<script>   
	$( "#foursquare" ).on( "pagebeforeshow", function() {	
	
	document.addEventListener("backbutton", onBackKeyDown, false);
		
	function onBackKeyDown(e) {
	e.preventDefault();
	}
	
	var	connectionStatus = navigator.onLine ? 'online' : 'offline';
	if (connectionStatus == "offline")
	{
	$.mobile.changePage( "#index", { allowSamePageTransition:true } );
	}
	
	$("h3.titoloCollegaFoursquare").html(window.localStorage.getItem("collegaSetupTitolo")+" Foursquare");
	$("p.descrizioneCollegaFoursquare").html(window.localStorage.getItem("collegaSetupDescrizione"));
	
	$("h2#h2skipFoursquare").html(""+window.localStorage.getItem("noCollegaSocial")+"");
	$("p#pskipFoursquare").html(""+window.localStorage.getItem("continua")+"");
	
	var tokenFoursquare = window.localStorage.getItem("tokenFoursquare");
	
		if(tokenFoursquare == null) {
		$("h2#h2loginFoursquare").html("Login Foursquare");
		$("p#ploginFoursquare").html(""+window.localStorage.getItem("collegaSocial")+"");
		}
		else {
		$.getJSON('https://api.foursquare.com/v2/users/self?oauth_token='+tokenFoursquare+'&v=20140304', function(data){
		var user = data['response']['user']['firstName'];

		
		$("h2#h2loginFoursquare").html(""+window.localStorage.getItem("accountCollegato")+"");
		$("p#ploginFoursquare").html(""+user+"");
		$("a.foursquare").attr("href", "#twitter");
		$("a.foursquare").removeClass('foursquare');
		$("h2#h2skipFoursquare").html("Avanti");
		$("p#pskipFoursquare").html(""+window.localStorage.getItem("continua")+"");

		});
		
		}
	
	}); //ON "pagebeforeshow"
	
	$(document).on("click", 'a.foursquare', function(){
	
	var ref = window.open('https://foursquare.com/oauth2/authenticate?client_id=OEAMDK1KRKXV2ZMYSFC5GMV3WZRPNSXDPHTGOUHFKPQLQ0VH&response_type=token&redirect_uri=http://shopincomo.comune.como.it/ccn20/closeFoursquare.html', '_blank', 'location=no');
	
	ref.addEventListener('loadstart', function(event) {
    closeFoursquare(event.url,ref);
	}); 
	
	function closeFoursquare(loc,ref) {
   
		if (loc.indexOf("shopincomo.comune.como.it/ccn20/closeFoursquare.html#") > -1){
		var tokenFoursquare = loc.substring(loc.indexOf("=")+1);
		window.localStorage.setItem("tokenFoursquare", tokenFoursquare);
		
		$.getJSON('https://api.foursquare.com/v2/users/self?oauth_token='+tokenFoursquare+'&v=20140304', function(data){
		var user = data['response']['user']['firstName'];
		var idFoursquare = data['response']['user']['id'];
		localStorage.setItem("idFoursquare", idFoursquare);
		$("h2#h2loginFoursquare").html(""+window.localStorage.getItem("accountCollegato")+"");
		$("p#ploginFoursquare").html(""+user+"");
		$("a.foursquare").attr("href", "#twitter");
		$("a.foursquare").removeClass('foursquare');
		$("h2#h2skipFoursquare").html(""+window.localStorage.getItem("prossimoPasso")+"");
		$("p#pskipFoursquare").html(""+window.localStorage.getItem("continua")+"");

		$.ajax({
		type: 'POST',
		url: 'http://shopincomo.comune.como.it/ccn20/utentiSocial.php',
		data: { idUtente: idFoursquare, socialNetwork: 'Foursquare'}
		}).done(function( msg ) {
		//alert(window.localStorage.getItem("postPubblicato"));
		});

		});
		
		ref.close();
		}
	}
	
	
	}); //ON "click"
		
	</script>
	
	<h3 class="titoloCollegaFoursquare"></h3>
	<p class="descrizioneCollegaFoursquare"></p>
	
	<ul data-role="listview" data-inset="true">
		<li><a href="#" class="foursquare" data-transition="slide">
			<img src="img/collegaFoursquare.png">
			<h2 id="h2loginFoursquare"></h2>
			<p id="ploginFoursquare"></p></a>
		</li>
		<li><a href="#twitter" data-transition="slide">
			<img src="img/skip.png">
			<h2 id="h2skipFoursquare"></h2>
			<p id="pskipFoursquare"></p></a>
		</li>
	</ul>
	
	</div>
	<!-- CONTENT -->

	<!-- FOOTER -->
	<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		<h4></h4>
	</div>
	<!-- /FOOTER -->

	</div>
<!-- /PAGE #foursquare -->

<!-- PAGE #twitter -->
	<div data-role="page" id="twitter">

	<!-- /HEADER -->
	<div data-role="header" data-position="fixed" data-tap-toggle="false">
		<h1></h1>
	</div>
	<!-- /HEADER -->
	
	<!-- CONTENT -->
	<div role="main" class="ui-content" >
	
	<script>   
	$( "#twitter" ).on( "pagebeforeshow", function() {	
	
	document.addEventListener("backbutton", onBackKeyDown, false);
		
	function onBackKeyDown(e) {
	e.preventDefault();
	}
	
	var	connectionStatus = navigator.onLine ? 'online' : 'offline';
	if (connectionStatus == "offline")
	{
	$.mobile.changePage( "#index", { allowSamePageTransition:true } );
	}
	
	$("h3.titoloCollegaTwitter").html(window.localStorage.getItem("collegaSetupTitolo")+" Twitter");
	$("p.descrizioneCollegaTwitter").html(window.localStorage.getItem("collegaSetupDescrizione"));
	
	$("h2#h2skipTwitter").html(""+window.localStorage.getItem("noCollegaSocial")+"");
	$("p#pskipTwitter").html(""+window.localStorage.getItem("continua")+"");
	
	var twitterToken = window.localStorage.getItem("twitterToken");
	
		if(twitterToken == null) {
		$("h2#h2loginTwitter").html("Login Twitter");
		$("p#ploginTwitter").html(""+window.localStorage.getItem("collegaSocial")+"");
		}
		else {
		
		var twitterName = window.localStorage.getItem("twitterName");
		
		$("h2#h2loginTwitter").html(""+window.localStorage.getItem("accountCollegato")+"");
		$("p#ploginTwitter").html(""+twitterName+"");
		$("a.twitter").attr("href", "#index");
		$("a.twitter").removeClass('twitter');
		$("h2#h2skipTwitter").html(""+window.localStorage.getItem("prossimoPasso")+"");
		$("p#pskipTwitter").html(""+window.localStorage.getItem("continua")+"");
		}
	
	}); //ON "pagebeforeshow"
	
	
	$(document).on("click", 'a.twitter', function(){
	
	var ref = window.open('http://shopincomo.comune.como.it/twitter/twitterConnect.php', '_blank', 'location=no');
		
		ref.addEventListener('loadstart', function(event) {
        closeTwitter(event.url,ref);
		});  
	
	function closeTwitter(loc,ref) {
   
		if (loc.indexOf("shopincomo.comune.como.it/twitter/twitterTokens.php?") > -1){
		
		var twitterToken = loc.substring(loc.indexOf("oauth_token=")+12, loc.indexOf("&"));
		var twitterVerifier = loc.substring(loc.indexOf("oauth_verifier=")+15, loc.indexOf("&t"));
		var twitterName = loc.substring(loc.indexOf("twitterName=")+12, loc.indexOf("&i"));
		var idTwitter = loc.substring(loc.indexOf("idTwitter=")+10);
		localStorage.setItem("idTwitter", idTwitter);
		twitterName = decodeURIComponent(twitterName);
		
		window.localStorage.setItem("twitterToken", twitterToken);
		window.localStorage.setItem("twitterVerifier", twitterVerifier);
		window.localStorage.setItem("twitterName", twitterName);
		
		$("h2#h2loginTwitter").html(""+window.localStorage.getItem("accountCollegato")+"");
		$("p#ploginTwitter").html(""+twitterName+"");
		$("a.twitter").attr("href", "#index");
		$("a.twitter").removeClass('twitter');
		$("h2#h2skipTwitter").html(""+window.localStorage.getItem("prossimoPasso")+"");
		$("p#pskipTwitter").html(""+window.localStorage.getItem("continua")+"");

		$.ajax({
		type: 'POST',
		url: 'http://shopincomo.comune.como.it/ccn20/utentiSocial.php',
		data: { idUtente: idTwitter, socialNetwork: 'Twitter'}
		}).done(function( msg ) {
		//alert(window.localStorage.getItem("postPubblicato"));
		});
		
		ref.close();
		}
	}
	
	}); //ON "click"
	
	</script>
	
	<h3 class="titoloCollegaTwitter"></h3>
	<p class="descrizioneCollegaTwitter"></p>
	
	<ul data-role="listview" data-inset="true">
		<li><a href="#" class="twitter">
			<img src="img/collegaTwitter.png">
			<h2 id="h2loginTwitter"></h2>
			<p id="ploginTwitter"></p></a>
		</li>
		<li><a href="#index" id="saltaAIndex" data-transition="slide">
			<img src="img/skip.png">
			<h2 id="h2skipTwitter"></h2>
			<p id="pskipTwitter"></p></a>
		</li>
	</ul>
	
	</div>
	<!-- CONTENT -->

	<!-- FOOTER -->
	<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		<h4></h4>
	</div>
	<!-- /FOOTER -->

	</div>
<!-- /PAGE #twitter -->



<!-- PAGE #credits -->
<div data-role="page" id="credits">

	<!-- /HEADER -->
	<div data-role="header" data-position="fixed" data-tap-toggle="false">
		<h1></h1>
		<a href="#index" class="ui-btn ui-icon-carat-l ui-btn-icon-notext ui-alt-icon ui-nodisc-icon" data-transition="flip" data-direction="reverse">indietro</a>
	</div>
	<!-- /HEADER -->
	
	<!-- CONTENT -->
	<div role="main" class="ui-content" >
	
	<script>   
	$( "#credits" ).on( "pagebeforeshow", function() {	
	
	document.addEventListener("backbutton", function(e){
    
		navigator.app.backHistory()
		
	}, false);
	
	});
		
	</script>
	
<ul id="creditsList" data-role="listview" data-inset="true">
    <li>
        <img src="img/politecnico.png">
		<h2>Politecnico di Milano - DEIB</h2>
		<p>Advisor: Prof. Emanuele Della Valle - emanueledellavalle.org</p>
		<p>Developers: Lorenzo Onofrio, Andrea Pozzetti</p>
    </li>
    <li>
        <img src="img/comunecomo.png">
		<h2>Comune di Como</h2>
		<p></p>
    </li>
    <li>
        <img src="img/cameracommercio.png">
		<h2>Camera di Commercio Como</h2>
		<p></p>
    </li>
    <li>
        <img src="img/confcommercio.png">
		<h2>Confcommercio Como</h2>
		<p></p>
    </li>
    <li>
        <img src="img/regionelombardia.png">
		<h2>Regione Lombardia</h2>
		<p></p>
    </li>
    <li>
        <img src="img/cna.png">
		<h2>CNA Como</h2>
		<p></p>
    </li>
    <li>
        <img src="img/confartigianato.png">
		<h2>Confartigianato</h2>
		<p></p>
    </li>
    <li>
        <img src="img/unindustria.png">
		<h2>Unindustria Como</h2>
		<p></p>
    </li>
    <li>
        <img src="img/compagniaopere.png">
		<h2>Compagnia delle Opere Como</h2>
		<p></p>
    </li>
    <li>
        <img src="img/confesercenti.png">
		<h2>Confesercenti</h2>
		<p></p>
    </li>
</ul>

	</div>
	<!-- /CONTENT -->
	
</div><!-- /PAGE #credits -->
</body>
</html>